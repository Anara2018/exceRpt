{"name":"exceRpt","tagline":"The extra-cellular RNA processing toolkit.  Includes software to preprocess, align, quantitate, and normalise smallRNA-seq datasets","body":"# Overview\r\nThe **ex**tra-**ce**llular **R**NA **p**rocessing **t**oolkit (**exceRpt**) was designed to handle the variable contamination and often poor quality data obtained from low input smallRNA-seq samples such as those obtained from extra-cellular preparations.  However the tool is perfectly capable of processing data from more standard cellular preparations and, with minor modifications to the command-line call, is also capable of processing WGS/exome and long RNA-seq data.\r\n\r\nThe schematic diagram below details the various stages of the exceRpt pipeline including pre-processing of the raw reads, removal of nuisance contamination, alignment to the endogenous (human/mouse) genome and annotated transcriptome, and finally alignment to a large number of exogenous sequences for detection of foreign nucleic acids.\r\n\r\n![exceRpt workflow diagram](https://dl.dropboxusercontent.com/u/2696693/exceRpt_workflow.png)\r\n\r\n***\r\n# How to use exceRpt\r\n## Genboree.org\r\nSigning up for an account on [Genboree.org](http://genboree.org) is by far the fastest way to start using exceRpt.  The Genboree Workbench provides a graphical interface to exceRpt that is free for academic use.  Set up a free account to use the [Genboree Workbench](http://genboree.org/java-bin/login.jsp), upload some data, and start using exceRpt, all via the browser ([instructions available here](http://genboree.org/theCommons/projects/exrna-tools-may2014/wiki/Small%20RNA-seq%20Pipeline)).\r\n\r\n## Docker\r\nSlightly more effort to get set up than using Genboree, but using the [Docker](https://www.docker.com) image is the best way to use exceRpt on your own machine/cluster.  The [exceRpt Docker image](https://hub.docker.com/r/rkitchen/excerpt) is pre-baked with all required dependencies and should 'just work' with minimal installation.  Docker is native on Red Hat Enterprise Linux distributions (RHEL) and also available on Amazon, enabling exceRpt to be run in the cloud.  Instructions are available for installing Docker on [Mac OS X](http://docs.docker.com/mac/started), [Linux](http://docs.docker.com/linux/started), [Windows](http://docs.docker.com/windows/started), and [Amazon Web Services](http://docs.aws.amazon.com/AmazonECS/latest/developerguide/docker-basics.html). \r\n\r\nAs with the manual installation described below, **you will also need to download the pre-compiled genome and transcriptome indices** for exceRpt to use.  These are too large to be included in the Docker image, but using these links you can download the exceRpt database files:\r\n\r\n* human ([hg19](http://homes.gersteinlab.org/people/rrk24/exceRpt/exceRptDB_hg19.tgz)); \r\n* human ([hg38](http://homes.gersteinlab.org/people/rrk24/exceRpt/exceRptDB_hg38.tgz));\r\n* mouse ([mm10](http://homes.gersteinlab.org/people/rrk24/exceRpt/exceRptDB_mm10.tgz)).\r\n\r\nOnce you have downloaded the desired genome database and have successfully installed and started Docker on your machine/cluster/AWS-instance only a few commands are required to install and run exceRpt.  \r\n\r\nTo download the exceRpt Docker image, type:\r\n\r\n    docker pull rkitchen/excerpt\r\n\r\nTo download the exceRpt database for your genome/species of interest (currently one of hg19, hg39, or mm10) use the following commands.  Here we'll download the latest build of the human genome and transcriptome (hg38):\r\n\r\n    mkdir ~/DirectoryContainingMyexceRptDatabase\r\n    cd ~/DirectoryContainingMyexceRptDatabase\r\n    wget http://homes.gersteinlab.org/people/rrk24/exceRpt/exceRptDB_hg38.tgz\r\n    tar -xvf exceRptDB_hg38.tgz\r\n\r\nTo run a fastq sample (located in `~/DirectoryContainingMyInputSample/HUMAN_SRR822469.fastq`) through the exceRpt pipeline, aligning to the hg38 genome+transcriptome we just downloaded:\r\n\r\n    docker run -v ~/DirectoryContainingMyInputSample:/exceRptInput \\\r\n               -v ~/DirectoryInWhichToPutMyResults:/exceRptOutput \\\r\n               -v ~/DirectoryContainingMyexceRptDatabase/hg38:/exceRpt_DB/hg38 \\\r\n               -t rkitchen/excerpt \\\r\n               INPUT_FILE_PATH=/exceRptInput/HUMAN_SRR822469.fastq\r\n\r\n**BEWARE**, exceRpt requires about **10GB of RAM** in order to function properly, runs on machines with less than this amount of available memory will very likely fail.\r\n\r\n## Analysis customisation options\r\nThere are a number of options available for customising the analysis that are specified using the command-line.  These are a list of the most commonly-modified options and their default values.\r\n\r\n    OUTPUT_DIR              \t[default 'NULL']\r\n    INPUT_FILE_PATH         \t[default 'NULL']\r\n    CALIBRATOR_LIBRARY      \t[default 'NULL'] [path to bowtie2 index containing spiked-in sequences]\r\n    RANDOM_BARCODE_LENGTH\t    [default '0'] [options: any integer. '0' disables random barcode removal]\r\n    RANDOM_BARCODE_LOCATION \t[default '-5p -3p'] [options: '-5p', '-3p', or '-5p -3p']\r\n    ENDOGENOUS_LIB_PRIORITY\t    [default 'miRNA,tRNA,piRNA,gencode,circRNA']\r\n    MAIN_ORGANISM_GENOME_ID     [default 'hg38'] [options: 'hg19', 'hg38', or 'mm10']\r\n    ADAPTER_SEQ                 [default 'guessKnown'] [options: 'none', 'guessKnown', or the actual nucleotide sequence of the 3' adapter]\r\n    MAP_EXOGENOUS               [default 'off'] [options: 'off', 'miRNA', or 'on']\r\n    N_THREADS                   [default '4']\r\n    EXE_DIR                     [location of the pipeline, database, and dependencies]\r\n\r\n## Manual installation\r\nThis is the most labour-intensive mode of using exceRpt, but it offers the most flexibility.  Generally not recommended unless you are very familiar with the *NIX environment, shell scripting, and makefile syntax.  Detailed instructions on how to install exceRpt and its various dependencies will [one day] be listed toward the bottom of this page.\r\n\r\nOnce all dependencies are installed, the exceRpt pipeline can be run on a human sample (here an SRA binary file) using default parameters using the following skeleton command:\r\n\r\n    make -f smallRNA_pipeline.mk \\\r\n        INPUT_FILE_PATH=~/DirectoryContainingMyInputSample/HUMAN_SRR822469.fastq \\\r\n        OUTPUT_DIR=~/DirectoryInWhichToPutMyResults\r\n\r\n\r\n***\r\n\r\n# Processing exceRpt output from multiple samples\r\nAlso provided is a script to combine output from multiple samples run through the exceRpt pipeline.  The script (`mergePipelineRuns.R`) will take as input a directory containing 1 or more subdirectories or zipfiles containing output from the makefile above. In this way, results from 1 or more smallRNA-seq samples can be combined, several QC plots are generated, and the read-counts are normalised ready for downstream analysis by clustering and/or differential expression.\r\n\r\n## Installation\r\nThis script is comparatively much simpler to install.  Once the R software (http://cran.r-project.org/) is set up on your system the script should automatically identify and install all required dependencies.  Again, this script is available on the Genboree Workbench (www.genboree.org) and is also free for academic use.\r\n\r\n## Using the script\r\n### On the command line\r\nThe Rscript application provides a neat means of running the script:\r\n\r\n    Rscript mergePipelineRuns.R ~/DirectoryContainingMyexceRptRuns\r\n\r\nHere, the directory in which the script will search for valid exceRpt output (`~/DirectoryContainingMyexceRptRuns`) should be the same as the (`~/DirectoryInWhichToPutMyResults`) specific when running each sample through exceRpt.\r\n\r\n### Interactively in R \r\nAlternatively in an interactive R session, the merge can be performed using the following two commands:\r\n\r\n    > source(\"mergePipelineRuns_functions.R\")\r\n    > processSamplesInDir(data.dir, output.dir)\r\n\r\nApart from some status messages, warnings, or possibly errors, no R objects are output from this function.  Instead several files are created that are described immediately below...\r\n\r\n## Script output\r\nSeveral files are output by the script in the location of the input exceRpt results (or somewhere else if explicitly specified).  All output files are prefixed with 'exceRpt_' and contain a variety of information regarding all samples input:\r\n\r\nFile Name | Description\r\n------------ | -------------\r\n**QC data:** | \r\n`exceRpt_DiagnosticPlots.pdf` | All **diagnostic plots** automatically generated by the merge script\r\n`exceRpt_readMappingSummary.txt` | **Read-alignment summary** including total counts for each library\r\n`exceRpt_ReadLengths.txt` | **Read-lengths** (after 3' adapters/barcodes are removed)\r\n**Raw transcriptome quantifications:** | \r\n`exceRpt_miRNA_ReadCounts.txt` | **miRNA** read-counts quantifications\r\n`exceRpt_tRNA_ReadCounts.txt` | **tRNA** read-counts quantifications\r\n`exceRpt_piRNA_ReadCounts.txt` | **piRNA** read-counts quantifications\r\n`exceRpt_gencode_ReadCounts.txt` | **gencode** read-counts quantifications\r\n`exceRpt_circularRNA_ReadCounts.txt` | **circularRNA** read-count quantifications\r\n**Normalised transcriptome quantifications:** | \r\n`exceRpt_miRNA_ReadsPerMillion.txt` | **miRNA** RPM quantifications\r\n`exceRpt_tRNA_ReadsPerMillion.txt` | **tRNA** RPM quantifications\r\n`exceRpt_piRNA_ReadsPerMillion.txt` | **piRNA** RPM quantifications\r\n`exceRpt_gencode_ReadsPerMillion.txt` | **gencode** RPM quantifications\r\n`exceRpt_circularRNA_ReadsPerMillion.txt` | **circularRNA** RPM quantifications\r\n**R objects:** | \r\n`exceRpt_smallRNAQuants_ReadCounts.RData` | **All raw data** (binary R object)\r\n`exceRpt_smallRNAQuants_ReadsPerMillion.RData` | **All normalised data** (binary R object)\r\n\r\n\r\n***\r\n# Manual Installation\r\n## Dependencies\r\n### Core dependencies\r\n* [Java v1.6+](https://java.com/en/download)\r\n* [fastx v0.0.14+](http://hannonlab.cshl.edu/fastx_toolkit)\r\n* [bowtie v1.1.1+](http://bowtie-bio.sourceforge.net/index.shtml)\r\n* [bowtie2 v2.2.4+](http://bowtie-bio.sourceforge.net/bowtie2/index.shtml)\r\n* [samtools v1.1+](http://sourceforge.net/projects/samtools/files/samtools)\r\n* [fastQC v0.11.2+](http://www.bioinformatics.babraham.ac.uk/projects/fastqc)\r\n\r\n### Optional dependencies\r\n* [sratoolkit v2.5.1+](https://github.com/ncbi/sra-tools) - required for processing .sra files from NCBI archival data\r\n* [STAR v2.4.2a+](https://github.com/alexdobin/STAR/releases) - required for most exogenous alignments\r\n\r\n## Installation steps (incomplete)\r\n1. Install dependencies\r\n2. Download exceRpt database(s)\r\n3. Configure the makefile\r\n\r\n***\r\n# Support\r\nRob Kitchen; rob [dot] kitchen [at] yale [dot] edu","google":"UA-69502165-1","note":"Don't delete this file! It's used internally to help with page regeneration."}